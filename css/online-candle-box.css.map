{
  "version": 3,
  "file": "online-candle-box.css",
  "sources": [
    "../online-candle-box/CandleBox.svelte"
  ],
  "sourcesContent": [
    "<script>\n\timport { onMount } from 'svelte';\n\timport { fade, fly } from 'svelte/transition';\n\n\texport let lang = 'ru';\n\texport let locations = [];\n\texport let products = [];\n\texport let paypalClientId;\n\texport let brandName = {};\n\texport let thankYouMessage = {};\n\n\tlet order = {};\n\tconst getQuantity = (loc, prod) => order[loc.id + '/' + prod.id] || 0;\n\n\tconst computeTotal = () => {\n\t\tlet temp =0;\n\t\tfor (const loc of locations) {\n\t\t\tfor (const prod of products) {\n\t\t\t\tconst quantity = getQuantity(loc, prod);\n\t\t\t\ttemp += quantity * prod.price;\n\t\t\t}\n\t\t}\n\t\treturn temp;\n\t};\n\n\tlet total = 0;\n\t$: {\n\t\ttotal = computeTotal(order);\n\t\tif (total === 0) shuffleCandlePositions();\n\t}\n\n\tconst clearOrder = () => {\n\t\torder = {};\n\t}\n\n\tconst increment = (loc, prod) => {\n\t\tconst quantity = getQuantity(loc, prod);\n\t\tif (quantity < prod.limit) {\n\t\t\torder[loc.id + '/' + prod.id] = quantity + 1;\n\t\t\torder = order;\n\t\t}\n\t};\n\tconst decrement = (loc, prod) => {\n\t\tconst quantity = getQuantity(loc, prod);\n\t\tif (quantity > 0) {\n\t\t\torder[loc.id + '/' + prod.id] = quantity - 1;\n\t\t\torder = order;\n\t\t}\n\t};\n\n\tconst shuffle = array => {\n\t\tfor(let i = array.length - 1; i > 0; i--) {\n\t\t\tconst j = Math.floor(Math.random() * i)\n\t\t\tconst temp = array[i]\n\t\t\tarray[i] = array[j]\n\t\t\tarray[j] = temp\n\t\t}\n\t\treturn array;\n\t};\n\n\tconst maxCandles = products.reduce((a,b)=>a + b.limit, 0)\n\tconst positions = {};\n\n\tfunction shuffleCandlePositions() {\n\n\t\tfor (const loc of locations) {\n\t\t\tpositions[loc.id] = {\n\t\t\t\tpos: shuffle([...Array(maxCandles).keys()]),\n\t\t\t\trotation: [...Array(maxCandles).keys()].map(()=>Math.random() * 10 - 5),\n\t\t\t};\n\t\t}\n\t}\n\n\tconst getCandles = loc => {\n\t\tconst candles = [];\n\t\tvar pos_index = 0;\n\t\tfor (const prod of products) {\n\t\t\tconst q = getQuantity(loc, prod);\n\t\t\tfor (let i = 0; i < q; i++) {\n\t\t\t\tcandles.push({\n\t\t\t\t\timage: prod.image,\n\t\t\t\t\tpos: 100 * (0.5 + positions[loc.id].pos[pos_index+i]) / maxCandles,\n\t\t\t\t\theight: prod.height,\n\t\t\t\t\trotate: positions[loc.id].rotation[pos_index+i],\n\t\t\t\t\tkey: loc.id + '/' + (pos_index + i),\n\t\t\t\t});\n\t\t\t}\n\t\t\tpos_index += prod.limit;\n\t\t}\n\t\treturn candles;\n\t}\n\n    let paypalReady = false;\n\tlet mounted = false;\n\tlet element;\n\n    onMount(() => {\n\t\tmounted = true;\n\t\tif (paypalReady) {\n\t\t\tloadPayPalButton();\n\t\t}\n\t});\n\n\tfunction initializePayPal() {\n\t\tpaypalReady = true;\n\t\tif (mounted) {\n\t\t\tloadPayPalButton();\n\t\t}\n\t}\n\n\tfunction createOrder(data, actions) {\n\t\tconst items = [];\n\t\tfor (const loc of locations) {\n\t\t\tfor (const prod of products) {\n\t\t\t\tconst q = getQuantity(loc, prod);\n\t\t\t\tif (q > 0) {\n\t\t\t\t\titems.push({\n\t\t\t\t\t\tname: 'candles',\n\t\t\t\t\t\tsku : prod.id + '/' + loc.id,\n\t\t\t\t\t\tunit_amount: {\n\t\t\t\t\t\t\tcurrency_code: 'USD',\n\t\t\t\t\t\t\tvalue: prod.price.toFixed(2),\n\t\t\t\t\t\t},\n\t\t\t\t\t\tquantity: q,\n\t\t\t\t\t\tdescription: prod.description[lang] + ' :: ' + loc.description[lang],\n\t\t\t\t\t\tcategory: 'DIGITAL_GOODS',\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst purchase_unit = {\n\t\t\tamount: {\n\t\t\t\tcurrency_code: 'USD',\n\t\t\t\tvalue: total.toFixed(2),\n\t\t\t\tbreakdown: {\n\t\t\t\t\titem_total: {\n\t\t\t\t\t\tcurrency_code: 'USD',\n\t\t\t\t\t\tvalue: total.toFixed(2),\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tdescription: 'Candles',\n\t\t\titems: items,\n\t\t};\n\n\t\treturn actions.order.create({\n\t\t\tpurchase_units: [purchase_unit],\n\t\t\tapplication_context: {\n\t\t\t\tbrand_name: brandName[lang],\n\t\t\t}\n\t\t});\n\t}\n\n\tfunction onApprove(data, actions) {\n\t\treturn actions.order.capture().then(function(details) {\n\t\t\t// console.log(details.payer);\n\t\t\t// console.log(details);\n\t\t\t// alert('Transaction completed by ' + details.payer.name.given_name + '!');\n\t\t\tclearOrder();\n\t\t\tsayThanks();\n\t\t});\n\t}\n\n\tconst onCancel = data => {\n\t\tconsole.log('Cancelled:', data);\n\t};\n\n    function loadPayPalButton() {\n\t\tpaypal.Buttons({\n\t\t\tstyle: {\n\t\t\t\tsize  : 'responsive',\n\t\t\t\tshape : 'pill',\n\t\t\t\tcolor : 'blue',\n\t\t\t\tlayout: 'vertical',\n\t\t\t\tlabel : 'paypal',\n\t\t\t\ttagline: false,\n\t\t\t},\n\t\t\tcreateOrder,\n\t\t\tonApprove,\n\t\t\tonCancel,\n\t\t}).render('#paypal-button-container');\n\t}\n\n\tlet thanks = false;\n\tfunction sayThanks() {\n\t\tthanks = true;\n\t\tsetTimeout(()=>{thanks=false}, 2500);\n\t}\n\n</script>\n\n<div class=\"row\" bind:this={element}>\n\t{#each locations as loc}\n\t\t<div class=\"col-md-4 col-sm-12\">\n\t\t<div class=\"candle-location\">\n\t\t<img src={loc.image} alt=\"\">\n\t\t{#each getCandles(loc, order) as candle (candle.key)}\n\t\t\t<div transition:fly={{y:100, duration:500}} class=\"candle\" style=\"left: {candle.pos}%; height: {candle.height};\">\n\t\t\t\t<img src={candle.image} style=\"transform: rotate({candle.rotate}deg);\" alt=\"\">\n\t\t\t</div>\n\t\t{/each}\n\t\t<div class=\"button-group\">\n\t\t<div class=\"row\">\n\t\t\t<div class=\"col-md-12 icon-header\">{loc.description[lang]}</div>\n\t\t</div>\n\t\t{#each products as prod}\n\t\t<div class=\"row\">\n\t\t<div class=\"col-sm-12\">\n\t\t<div class=\"button-row\">\n\t\t\t<button class=\"btn btn-default btn-circle button-left\" on:click={()=>decrement(loc, prod)}>-</button>\n\t\t\t<span class=\"descr\">{prod.description[lang]}: ${prod.price.toFixed(2)} &times;{getQuantity(loc, prod, order)}</span>\n\t\t\t<button class=\"btn btn-default btn-circle button-right\" on:click={()=>increment(loc, prod)}>+</button>\n\t\t</div>\n\t\t</div>\n\t\t</div>\n\t\t{/each}\n\t\t</div>\n\t\t</div>\n\t\t</div>\n\t{/each}\n</div>\n<div class=\"row total\" class:flex={total > 0}>\n\t<div id=\"paypal-button-container\" class=\"col-sm-6 paypal-ugly\"></div>\n\t<div class=\"amount col-sm-3\">${total.toFixed(2)}</div>\n\t<div class=\"col-sm-3\"><button class=\"btn btn-circle btn-danger cancel\" on:click={clearOrder}><i class=\"fa fa-times\"></i></button></div>\n</div>\n{#if thanks}\n<div class=\"row thanks\" transition:fade>\n\t{thankYouMessage[lang]}\n</div>\n{/if}\n<svelte:head>\n<script\n    src=\"https://www.paypal.com/sdk/js?client-id={paypalClientId}&currency=USD&disable-funding=card,credit\"\n    data-sdk-integration-source=\"button-factory\" on:load={initializePayPal}></script>\n</svelte:head>\n\n<style>\n.total {\n\tbackground-color: #777e;\n\tposition:fixed;\n\ttop: 0;\n\tleft: 15px;\n\twidth:100%;\n\tz-index: 2000;\n\tline-height: 2em;\n\tflex-direction: row;\n\tflex-wrap: wrap;\n\tjustify-content: center;\n\tdisplay: none;\n}\n\n.paypal-ugly {\n\tmargin-top: 0.5em;\n}\n\n.candle-location > img {\n\twidth: 100%;\n\tmax-width: 1660px;\n\theight: auto;\n}\n.icon-header {\n\ttext-align: center;\n\tfont-size: 1.35rem;\n\tfont-weight: bolder;\n\tcolor: lightyellow;\n}\n.candle-location {\n\tposition: relative;\n\tpadding-top: 0.5em;\n\tpadding-bottom: 0.5em;\n}\n.button-group {\n\tposition: absolute;\n\tbottom: 0.5em;\n\tbackground-color: #00000075;\n\twidth: 100%;\n\ttext-align: center;\n}\n.btn-circle {\n\twidth: 2em;\n\theight: 2em;\n\tline-height: 2em; /* adjust line height to align vertically*/\n\tpadding:0;\n\tborder-radius: 50%;\n\tfont-weight: bold;\n}\n.button-row {\n\tdisplay: flex;\n\tflex-direction: row;\n\tflex-wrap: nowrap;\n\twidth: 100%;\n}\n.descr {\n\tdisplay: inline-block;\n\tcolor: lightyellow;\n\tfont-size: 1.35rem;\n\tflex-grow: 1;\n\tline-height: 2.5rem;\n}\n@media (max-width: 996px) {\n\t.descr {\n\t\tfont-size: 2.35rem;\n\t}\n\t.icon-header {\n\t\tfont-size: 2.5rem;\n\t}\n}\n.button-left {\n\tflex-shrink: 0;\n}\n.button-right {\n\tflex-shrink: 0;\n}\n.amount {\n\tfont-size: 2.5em;\n\tfont-weight: bolder;\n\tline-height: 2.0em;\n\tcolor: lightgray\n}\n.cancel {\n\tmargin-top: 1em;\n\tmargin-bottom: 1em;\n\tfont-size: 18px;\n}\n.candle {\n\tposition: absolute;\n\tbottom: 7em;\n\twidth: 3%;\n\t/* background-color: white; */\n}\n.candle > img {\n\tmax-height: 100%;\n\twidth: auto;\n}\n.thanks {\n\tfont-size: 3em;\n    position: fixed;\n    top: 0;\n    left: 15px;\n    z-index: 3000;\n\tbackground-color: lightgray;\n\tcolor: #555;\n    width: 100%;\n\ttext-align: center;\n\tpadding: 1em;\n}\n.flex {\n\tdisplay: flex;\n}\n</style>\n"
  ],
  "names": [],
  "mappings": "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"
}